package client.facade;

import client.RecordIndexerFrame;
import client.communication.ClientCommunicator;
import client.login.LoginDialog;
import shared.communication.Validate_User_Parameter;
import shared.communication.Validate_User_Response;
import shared.modal.User;

public class ClientFacade {

	private static ClientCommunicator communicator;
	private static LoginDialog loginDialog;
	private static RecordIndexerFrame mainFrame;
	
	
	public static User validateUser(String username, String password) {
		
		try {
			//Start Client Communicator
			communicator = new ClientCommunicator(host, port);
		} catch (Exception e) {
			view.loginFailed("Error connecting, please check host and port and try again");
			return;
		}
		
		try {
			
			//Validate User
			Validate_User_Parameter param = new Validate_User_Parameter(username, password);
			Validate_User_Response response = clientCommunicator.validateUser(param);
			if (response.getOutput().equals("FALSE")) {
				view.loginFailed("Wrong username and password");
			} else if (response.getOutput().equals("FAILED")) {
				view.loginFailed("Error: please try again later");
			} else {
				this.username = username;
				this.password = password;
				
				view.loginSuccesfull();
				
				getProjects();
			}
		} catch (Exception e) {
			view.loginFailed("Error: please try again later");
		}
		
		return null;
	}
	
	//Getters and Setters
	
	public static void setLoginDialog(LoginDialog loginDialog) {
		ClientFacade.loginDialog = loginDialog;
	}
	
	public static void setMainFrame(RecordIndexerFrame mainFrame) {
		ClientFacade.mainFrame = mainFrame;
	}
	
	public static void clientCommunicator(ClientCommunicator communicator) {
		ClientFacade.communicator = communicator;
	}
}
