package client.facade;

import client.RecordIndexerFrame;
import client.communication.ClientCommunicator;
import client.login.LoginDialog;
import shared.communication.Validate_User_Parameter;
import shared.communication.Validate_User_Response;
import shared.modal.User;

public class ClientFacade {

	private static ClientCommunicator communicator;
	private static LoginDialog loginDialog;
	private static RecordIndexerFrame mainFrame;
	
	private static String username;
	private static String password;
	
	public static User validateUser(String username, String password) {
		
		try {
			
			//Validate User
			Validate_User_Parameter param = new Validate_User_Parameter(username, password);
			Validate_User_Response response = communicator.validateUser(param);
			if (response.getOutput().equals("FALSE")) {
				loginDialog.loginFailed("Wrong username and password");
			} else if (response.getOutput().equals("FAILED")) {
				loginDialog.loginFailed("Error: please try again later");
			} else {
				ClientFacade.username = username;
				ClientFacade.password = password;
				
				User user = new User(username, password, response.getFirstName(), response.getLastName(), null, response.getRecordCount());
				
			}
		} catch (Exception e) {
			loginDialog.loginFailed("Error: please try again later");
		}
		
		return null;
	}
	
	//Getters and Setters
	
	public static void setLoginDialog(LoginDialog loginDialog) {
		ClientFacade.loginDialog = loginDialog;
	}
	
	public static void setMainFrame(RecordIndexerFrame mainFrame) {
		ClientFacade.mainFrame = mainFrame;
	}
	
	public static void setClientCommunicator(ClientCommunicator communicator) {
		ClientFacade.communicator = communicator;
	}
}
